## 1.a.
우선, matlab을 이용해 이산시간 제어기와 제어 플랜트, 샘플러, 영차 홀드로 이루어진 openloop transfer function을 만들어 bode diagram, root locus, nyquist plot을 그립니다. 또한, for문과 if문을 활용하여 phase margin을 표시합니다.

```MATLAB
% 모델 생성
num = [5 20];
den = [1 0.5 4];
Gp_tf = tf(num,den);

T=0.2;
Gd_tf = c2d(Gp_tf,T,'zoh');

% 제어기 생성
% wp =< w0
w0 = 1;
wp = 1;
Kc = 1;

% z = e^{sT}
z0 = exp(w0*T);
zp = exp(wp*T);

num = [1 z0];
den = [1 zp];
Cd_lag_tf = Kc*tf(num,den,T);

% open loop transfer function 생성
openloop_tf = Cd_lag_tf*Gd_tf;

% bode plot 생성
[mag,phase,wout]=bode(openloop_tf);

% phase margin 찾아 출력. 없으면 알려줌.
for i = 2:length(wout)
    mag0 = log(mag(:,:,i-1));
    mag1 = log(mag(:,:,i));
    if mag0 > 0 && mag1 < 0
        ph_margin0 = 180+phase(:,:,i-1);
        ph_margin1 = 180+phase(:,:,i);
            
        % 두 data point를 잇는 선을 가정하여 
        % 비교적 정확한 데이터를 만든다.
        ph_margin = (-ph_margin0*mag1 + ph_margin1*mag0)/(mag0-mag1);
        w_gain0 = (-wout(i-1)*mag1 + wout(i)*mag0)/(mag0-mag1);

        fprintf("phase margin : %f(deg)\n",ph_margin);
        fprintf("freq : %f(rad/s)\n",w_gain0);
        break
    end
    if i == length(wout)
        disp("gain(dB)이 0인 곳이 없음");
    end
end

%bode diagram, root locus, nyquist plot 출력
subplot(2,2,2);
bode(openloop_tf)
subplot(2,1,2);
rlocus(openloop_tf)
subplot(2,2,1);
nyquist(openloop_tf)

% 제어기 출력
Cd_lag_tf
```

이 코드에서 조정할 것은 `w0`, `wp`, `Kc`로 구성됩니다.

우선 `wp`, `w0`, `Kc`를 모두 1로 두어 플랜트의 특성을 알아봅니다.

![](Pasted%20image%2020240611214810.png)

```MATLAB
phase margin : 28.788229(deg)
freq : 6.631223(rad/s)

Cd_lag_tf =
 
  z + 1.221
  ---------
  z + 1.221
 
샘플 시간: 0.2 seconds
이산시간 전달 함수입니다.
```

이 플랜트는 phase margin이 28.7정도 되며, 기본적으로 안정적입니다.

--- 
 
`wp`, `w0`를 각각 0.1, 1로 설정하면 다음과 같이 출력됩니다.



```MATLAB
phase margin : 33.475058(deg)
freq : 7.198264(rad/s)

Cd_lag_tf =
 
  z - 1.221
  ---------
  z - 1.02
 
샘플 시간: 0.2 seconds
이산시간 전달 함수입니다.
모델 속성
```

여기에서 `wp`와 `w0`의 간격을 더 늘려보았지만 phase margin은 대부분 줄어들었습니다. 따라서 DC gain `Kc`를 0.2로 줄여보았습니다. 결과는 다음과 같습니다.



```MATLAB
phase margin : 51.491942(deg)
freq : 3.097812(rad/s)

Cd_lag_tf =
 
  0.2 z - 0.2443
  --------------
     z - 1.02
 
샘플 시간: 0.2 seconds
이산시간 전달 함수입니다.
모델 속성
```



## 1.b.



## 1.c.
## 1.d.
## 1.e.
## 2.a.
## 2.b.
## 2.c.
## 3.a.
## 3.b.
## 3.c.
## 3.d.
## 3.e.
## 3.f.
